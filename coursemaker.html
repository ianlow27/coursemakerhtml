<!DOCTYPE html><html><head><script>
let coursename='';
let coursedesc='';
let coursefldr='';
let sectionfldr='';
let sectionlist="";
let lesson01='';let lesson02='';let lesson03='';let lesson04='';let lesson05='';let lesson06='';let lesson07='';let lesson08='';let lesson09='';
let lesson10='';let lesson11='';let lesson12='';let lesson13='';let lesson14='';let lesson15='';let lesson16='';let lesson17='';let lesson18='';let lesson19='';
let lesson20='';let lesson21='';let lesson22='';let lesson23='';let lesson24='';let lesson25='';let lesson26='';let lesson27='';let lesson28='';let lesson29='';
let lesson30='';let lesson31='';let lesson32='';let lesson33='';let lesson34='';let lesson35='';let lesson36='';let lesson37='';let lesson38='';let lesson39='';let lesson40='';let lesson41='';let lesson42='';let lesson43='';let lesson44='';let lesson45='';let lesson46='';let lesson47='';let lesson48='';let lesson49='';let lesson50='';
</script>
<script src='./coursedata.js'></script>
<script>
//-----------------------------------
let startqst=1; //0;//2; //2;// 0;
let asections=Array(); 
const atmpsects=sectionlist.split(/%%%/);
for(i in atmpsects){
  const atmp1=atmpsects[i].split(/\|/);
  asections[atmp1[1]]=atmp1[0];
}//endfor
//alert(22);
//==========================================
let currpartid=0;
let prevpartid=0;
const appref='coursemakerhtml_'+coursefldr+'_'+sectionfldr+'_';
let part01='';let part02='';let part03='';let part04='';let part05='';let part06='';let part07='';let part08='';let part09='';
let part10='';let part11='';let part12='';let part13='';let part14='';let part15='';let part16='';let part17='';let part18='';let part19='';
let part20='';let part21='';let part22='';let part23='';let part24='';let part25='';let part26='';let part27='';let part28='';let part29='';
let part30='';let part31='';let part32='';let part33='';let part34='';let part35='';let part36='';let part37='';let part38='';let part39=''; let part40='';let part41='';let part42='';let part43='';let part44='';let part45='';let part46='';let part47='';let part48='';let part49='';let part50='';
//!!
//alert(46);
</script>

<style>
textarea {font-size:80%;}
button {font-size:80%;}
</style> 
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/>
</head>
<body id='bd1' style='padding:6px;font-size:80%;font-family:Times New Roman;xcolor:white;background-color:#efefea;'>
<div id='dvscr'></div>
<div id='dvstat'></div>
<center>
<b>CourseMakerHTML</b> 0.0.7_250104-1929<br/>
<textarea id='tx1' style='display:none;width:95%;height:100px;'></textarea>
<i><span id='h6part' style='text-decoration:italic;'></span></i>
<br/><span id='h3part' style='font-weight:bold;font-size:128%;'></span> <!-- !! -->
<br/><span id='h1part' style='font-weight:normal;font-size:110%;'></span> <!-- !! -->
</center>
<br/><button id='btn1' style='display:none;' onclick='gencourse();'>Begin</button>
<div id='dv1' style='font-weight:normal;'></div>
<script>
//alert(11111);
//!!
let currsect=1;
let currsectname='';
let currpart=1;
let currpartname='';
let currqst=1;
let totparts=0;
let totsects=0;

let gmtotqstn=0;
let gmtotrght=0;
let gmtotwrng=0;


//alert(sprintf0d(2, currpart));
//if(localStorage.getItem(appref+'tx1')==null){
//  localStorage.setItem(appref+'tx1', eval('part'+sprintf0d(2,currpart)) );
//}
//---------------------------
//alert(eval('part'+'01'));
tx1=document.getElementById('tx1');tx1.value='';
dv1=document.getElementById('dv1');
h1part=document.getElementById('h1part'); //!!
h6part=document.getElementById('h6part'); //!!
h3part=document.getElementById('h3part'); //!!
btn1=document.getElementById('btn1');
dvstat=document.getElementById('dvstat');
bd1=document.getElementById('bd1');
dvscr=document.getElementById('dvscr');
tx1.value=eval('part'+sprintf0d(2, currpart)); //localStorage.getItem(appref+'tx1');
let alines1 = Array(); //tx1.value.split(/\n/);
let alines = Array();
//=============================
//alert(31);
//let loadjs=function(jsfile, onloadfunc){
function loadjsxx(jsfile, onloadfunc){
  //prevpartid=currpartid;
  //currpartid++;
dbg(jsfile);
    const scriptobj = document.createElement('script');
    scriptobj.src = jsfile;
    scriptobj.id='currlib';
    scriptobj.onload = onloadfunc;
    scriptobj.onreadystatechange = onloadfunc;
    document.body.appendChild(scriptobj);
}//;//endfunc

function loadjs(psectionfldr, pcurrpart){
//dbg(jsfile);
const jsfile='./'+coursefldr+'/'+psectionfldr+'/part'+sprintf0d(2,pcurrpart)+'.js';
    const scriptobj = document.createElement('script');
 //alert(jsfile);
    scriptobj.src = jsfile;
    scriptobj.id='scr_'+psectionfldr+'_'+pcurrpart;
    scriptobj.onload = loadedjs;
    scriptobj.onreadystatechange = loadedjs;
    dvscr.appendChild(scriptobj);
}//;//endfunc

//---------------
function unloadjs(psectionfldr, pcurrpart){
dbg(101);
try{
  
  
const parent = document.getElementById("dvscr");
const child = document.getElementById('scr_'+psectionfldr+'_'+pcurrpart);
const throwawayNode = parent.removeChild(child);

  //if(child.parentNode){
   // child.parentNode.removeChild(child);
  //}
  
  
  
  /*
  
  let prevpart=document.getElementById('scr_'+psectionfldr+'_'+pcurrpart);
  //const parent1=prevpart.parentNode;
  //parent1.removeChild(prevpart);
  delete prevpart;
  */
}catch(e){
  alert('>>e:'+e.message);
}
}//endfunc
//----------------
let loadedjs=function(){
dbg(totparts,currpart);
  totparts=currpart; 
  if(eval('part'+sprintf0d(2,currpart+1))!=''){
    totparts= currpart+1;
  }
  //alert(loadedtest1());
  currqst=startqst;
//alert(1+'____'+currpart);
try{
  if(!currqst){
//alert(2);
    showlandingpg();
  }else {
//alert('121>>Loaded!!!');
    gencourse();//<===!!!!!!!!!!!!!
  }
}catch(e){
  alert('>>e:'+e.message);
}
};//endfunc
//=============================
//alert('1335'+currpart);

//alert('currpart__'+currpart);

try{
  //alert(sectionfldr+'___'+currpart);
  loadjs(sectionfldr, currpart);
  //loadjs('./'+coursefldr+'/'+sectionfldr+'/part'+sprintf0d(2,currpart)+'.js', loadedjs);
  //loadjs('./'+coursefldr+'/'+sectionfldr+'/part'+sprintf0d(2,currpart+1)+'.js', loadedjs);
  //alert(33);
}catch(e){
  dbg(e.message);
}

//=============================
//=============================
function gencourse(){

try{
 dbg(144);
  if(!initgencourse()) return; //!!
 dbg(146);
  //localStorage.setItem(appref+'tx1', tx1.value);
  tx1.style.display='none';
  btn1.style.display='none';
 
  let strout='';
 
  for(i in alines){
    let qststr="";
    let ansstr='';
    let ansidstr='';
    let functype='';
    const i1 = Number(i)+1;
    if(currqst > alines.length){
      //alert('End of part');
      functype='endcourse';
      strout='<h2>End of Part</h2>';
      strout+=  "<br/><button id='btnbk' onclick='goback();'>Back</button>&emsp;&emsp;";
      if(currpart < totparts){
      }
      break;
    }
    if(i1 > currqst) break;
    if(i1 < currqst) continue;
    alines[i] = alines[i].replace(/^[\s\*\-\_\=]+/g, "");
    const aqst=alines[i].split(/\|/);
//alert(aqst.length);
    let asel=Array();
    if(typeof aqst[1] != 'undefined') 
      asel=aqst[1].split(/\[/);
    const aqst1=aqst[0].split(/%%%/);
    aqst[0]=aqst1[0];
    if(aqst.length < 2){
      //alert(776);
      functype="info";
      //qststr=aqst[0];
      //alert(1);
    }else if(aqst.length == 2){
      functype="fillblanks";
      for(j in asel){
        //alert(asel[j]);
        if(asel[j].match(/\]/)){
          const atmp1=asel[j].split(/\]/);
          if(ansstr!="") ansstr+="|";
          ansstr+=atmp1[0];
          if(ansidstr!="") ansidstr+="|";
          ansidstr+='ans'+i1+'_'+j;
          qststr+="<input id='"+'ans'+i1+'_'+j+ "' style='width:50px' name='"+aqst[j]+"'></input>"+atmp1[1];
        }else {
          qststr+=asel[j];
        }
       // qststr+="</input>"+asel[j];
      }//endfor
      //alert(qststr);
      //alert(ansstr);
      //alert(ansidstr);
    }else {
      let itype='radio';
      let countsel=0
      for(let j=1; j<aqst.length; j++){
        if(aqst[j].match(/\]/)){
          countsel++;
        }
      }//endfor
      if(countsel>1) itype='checkbox';
      for(let j=1; j<aqst.length; j++){
        functype="multiselect";
        if(ansstr!="") ansstr+="|";
        if(aqst[j].match(/\]/)){
          ansstr+="true";
        }else{
          ansstr+="false";
        }
        let qstidx=0;
        if(itype=='checkbox') qstidx=j;
        const atmp1=aqst[j].split(/%%%/);
        if(ansidstr!="") ansidstr+="|";
        ansidstr+='ans'+i1+'_'+j;
        qststr+="<input type='"+itype+"' id='"+'ans'+i1+'_'+j+ "' name='"+aqst[qstidx]+"' style='width:50px'/>"+
           atmp1[0].replace(/[\[\]]/g,'')+
           "</label><br/>";
      }//endfor
    }//endif

    let btnstr='Submit';
    if(functype=='info') btnstr='Continue';
    if(functype=='endcourse') btnstr='Finish';
    bckstr='';
    if(i1>1) bckstr =
       "<button id='btnbk' onclick='goback();'>Back</button>&emsp;&emsp;";

    strout+= //!!
      "<div id='qst"+i1+"' style='display:none;'>"+
      //i1 +"/"+alines.length + " "+
     
      //----------------------!!

 
      aqst[0]
         .replace(/##(\d+)/g, currpart+'.'+currqst+'.'+"$1 ")
         .replace(/##(\s+)/g, currpart+'.'+currqst+''+"$1")
         .replace(/''([\w\-\s\.\-_]+)''/g, "<i>$1</i>")
         .replace(/\{\{/g, '<b>')
         .replace(/\}\}/g, '</b>')
         .replace(/>>/g, '<br/>')
         .replace(/\{([a-z0-9]+)\.mp4\}/g, "<video controls width='96%' controlslist='nofullscreen nodownload noremoteplayback noplaybackrate foobar' ><source src='./"+coursefldr+"/"+sectionfldr+"/$1.mp4' type='video/mp4' /></video>")
         + "<br/>"+
      qststr+ "<br/><br/><br/>"+
      //----------------------!!
      
      bckstr +
      "<button id='qbtn"+i1+"' onclick='procans(\"" + functype + "\",\""+ansstr+"\",\""+ansidstr
        +"\",\""
        +( (typeof aqst1[1]!='undefined')
          ? aqst1[1] : '' ) 
        +"\",\""
        +( (typeof aqst1[2]!='undefined')
          ? aqst1[2] : '' ) 
          +"\");'>"+btnstr+"</button>" +
      "</div>"; 

  }//endfor
  //alert(appref);
  dv1.innerHTML=strout;
  document.getElementById('qst'+currqst).style.display='block';
  
}catch(e){
  alert('>>e:'+e.message);
}

}//endfunc
//--------------------------------------
function procans(ptype, pans, pansid, pwrngmsg='', predir=''){
try{
  //alert(ptype);
if(ptype=='info'){
  //alert(256);
   incrlevel(); //currqst++; //!!
}else {
  //alert(pans);
  //alert(pansid);
  const aansid=pansid.split(/\|/);
  const aans=pans.split(/\|/);
  let bnextq = true;
  gmtotqstn++;
  let wrngmsg='';
  for(i in aansid){
    const obj = document.getElementById(aansid[i]);
    const atmp1=obj.name.split(/%%%/);
    if(ptype=="fillblanks"){
      if(obj.value  != aans[i]){
         //alert("xYour answer '"+obj.value+"' is incorrect.");
         if(typeof atmp1[1]!='undefined')
           wrngmsg+=atmp1[1]+'\n';
         bnextq = false;
      }
    }else if(ptype=="multiselect"){
      if(String(obj.checked) != String(aans[i])){
        
        //alert(obj.id+'___'+aansid[i]+'_____'+obj.value);
         if(typeof atmp1[1]!='undefined')
           wrngmsg+=atmp1[1]+'\n';       
        /* alert("Your answer"+
     String(obj.checked)+"____"+String(aans[i])+
         " '"+obj.value+"' xis incorrect."); */
         bnextq = false; 
      }
    }
  }//endfor
  if(bnextq){
    alert("Well done! Your answer was correct!");
    gmtotrght++; dbg('CORRECTANS');
    incrlevel(); //currqst++; //!!
  }else {
    gmtotwrng++; dbg('INCORRECTANS');
    //currqst=1;
    //currpart=1;
    //currsect=1;;
    if(wrngmsg.trim()){
      alert('>>1'+wrngmsg.trim());
    }else {
      alert('Your answer was incorrect');
    }
    if(pwrngmsg){
      alert('>>2'+pwrngmsg);
    }
    if(predir){
      const aredir=predir.split(/%%/);
      //alert(predir);
      startsection(aredir[0],
          Number(aredir[1]),
          Number(aredir[2]));
    }
  }
}//endif
}catch(e){
  alert('>>e:'+e.message);
}
  gencourse();
}//endfunc
//--------------------------------------
function goback(){ //!!
  currqst--;
  gencourse(); 
}//endfunc
//---------------------
function incrlevel(ptype='qst'){ //!!
  if(ptype=='qst'){
    currqst++;
    if(currqst>(alines.length)){
      alert('end of part') ;
      currpart++;
      currqst=1;
      if(currpart>totparts){
        currsect++;
        showlandingpg();
        alert('end of course');
      }else{
        gencourse();
      }
    }
  }else{
  }
}//endfunc
//---------------------
function sprintf0d(pwidth=2, pval=0){ //!!
  if(pwidth>10) pwidth=10;
  if(isNaN(pval)) pval=0;
  if(pval<0) pval=0;
  pbase='1';
  for(let i=0; i<(pwidth-1); i++){
    pbase+='0';
  }
  const retval = (String(pbase).length - String(pval).length) + 1;
  return retval > 0 ? 
       new Array(retval).join('0') + pval :
       pval;
}
//--------------------------------------
function initgencourse(){ //!!
dbg('386>>part'+sprintf0d(2, currpart));
tx1.value=eval('part'+sprintf0d(2, currpart));
//currqst=1;
alines1 = tx1.value.split(/\n/);
alines = Array();
dbg('391>>'+tx1.value);
for(i in alines1){
//dbg(alines1[i]);
  alines1[i]=alines1[i].trim();
  if(alines1[i]==""){
  }else if((alines1[i].substr(0,1)=="{")
     && (alines1[i].substr(alines1[i].length-1,1)=='}')){
    //coursename =alines1[i].substr(1,alines1[i].length-2);
  }else if((alines1[i].substr(0,2)=="/*") && (alines1[i].substr(alines1[i].length-2,2)=='*/')){
       //dbg('___111'+alines1[i].substr(alines1[i].length-2,2));
    //do nothing ignore comment
  }else if((alines1[i].substr(0,1)=="[")
     && (alines1[i].substr(alines1[i].length-1,1)==']')){
    currpartname =alines1[i].substr(1,alines1[i].length-2);
  }else{
    alines.push(alines1[i]);
  }
}//endfor
//currsectname=asections[sectionfldr];
h6part.innerHTML=coursename;
h3part.innerHTML=asections[sectionfldr];
h1part.innerHTML='Part '+currpart 
+ ' ('+currqst+'/'+alines.length +')'
+(currpartname!=''? ': '+currpartname : '');

try{

totparts=0;
for(i=1; i<=10; i++){
  if(typeof eval('part'+sprintf0d(2,i)) =='undefined'){ 
  //dbg('----1',i);
  break;
  }else if(String(eval('part'+sprintf0d(2,i))).trim()==''){ 
    //dbg('part'+sprintf0d(2,i));
	  //dbg('----2',i);
break;
  }else {
    //alert('['+eval('part'+sprintf0d(2,i)).trim()+']')
    totparts=i;
  }
}//endfor
//if(!totparts) totparts=1;
//dbg(currpart, totparts);
if(currpart > totparts){
  //h1part.innerHTML = 'Congratulations! You have completed the section!';
  return 0;
}
//dbg('totparts='+totparts);
//====================================
//====================================
//====================================
if(!currqst){
  currqst=1;
  let strout='jjggg jhgffx jh';
  dv1.innerHTML=strout;
  return 0;
}
//====================================
//====================================
//====================================
}catch(e){
  alert('>>e:'+e.message);
}
return 1;
}//endfunc
//--------------------------------------
function showlandingpg(){
try{
//alert('currsect_'+currsect);
  h6part.innerHTML=coursename;
  h1part.innerHTML=coursedesc;
  let strout='';
  const asects=sectionlist.split(/%%%/);
  for(i in asects){
    const atmp1=asects[i].split(/\|/);
    if(strout!='') strout+='<br/>';
    strout+='<b style="font-size:110%;">'+atmp1[0]+': </b>' + atmp1[2] +  "<div style='text-align:right;'><button style='text-align:right;";
    if(currsect > i){
     strout+="'  onclick='startsection( \""+atmp1[1]+"\");'>";// , \""+atmp1[0]+"\");'>";
    }else {
      strout+="color:#bbb'>";
    }
    strout+='Start</button></div>';
  }//endfor

  
  dv1.innerHTML=strout;
  return 0;
}catch(e){
  alert('>>e:'+e.message);
}
}//endfunc
//--------------------------------------
function startsection(psection,pcurrpart=1,pcurrqst=1){
dbg(psection);
try{
  unloadjs(sectionfldr, currpart);
  //alert(2);
  
  part01='';
  
  
  currqst=pcurrqst;
  currpart=pcurrpart;
  startqst=pcurrqst;
  sectionfldr=psection;
  //currsectname=pname;
dbg(468);
   loadjs(sectionfldr, currpart);
   if(!part01)    loadjs(sectionfldr, currpart);
   //loadjs('./'+coursefldr+'/'+sectionfldr+'/part'+sprintf0d(2,currpart)+'.js', loadedjs);
   
  //alert(33);
}catch(e){
  alert('>>e:'+e.message);
}
}//endfunc
//--------------------------------------
function dbg(pstr,pstr1='',pstr2='',) {
  const e = new Error();
  const regex = /^(.*)\((.*):(\d+):(\d+)\)$/
  const match = regex.exec(e.stack.split("\n")[2]);
  
  //alert(
  dvstat.innerHTML =
  '['+match[1].trim()+': l.'+match[3]+']\n'
   +'coursefldr='+coursefldr+' ;'
   +'totsects='  +totsects +'; '
   +'totparts='  +totparts +'; \n'
   +'sectionfldr='  +sectionfldr +'; '
   +'currsect='  +currsect +'; '
   +'currpart='  +currpart +'; '
   +'currqst='   +currqst  +'; \n'
   +'gmtotqstn=' +gmtotqstn+'; '
   +'gmtotrght=' +gmtotrght+'; '
   +'gmtotwrng=' +gmtotwrng+'; '
   +pstr+'___'+pstr1 ; 
  // ); 
}


//--------------------------------------
//alert(8888);
//--------------------------------------
//--------------------------------------
//--------------------------------------
//--------------------------------------
//--------------------------------------
</script></body></html>